var chatVM=new Vue({el:"#chatframe",data:{message:"",user:null,io:null},computed:{placeholder:function(){return"Press [Enter \u21b5] to send message as "+this.username},username:function(){return(this.user||{username:""}).username}},methods:{_bold:function(a){a.style.fontWeight="bold";return a},_gray:function(a){a.style.color="gray";return a},_status:function(a){a=this._gray(a);return a=this._bold(a)},_mono:function(a){a.style.fontFamily="monospace";return a},span:function(a,b){b=void 0===b?!1:b;
var c=document.createElement("span"),d=document.createTextNode(a);b&&(c=this._mono(c));c.appendChild(d);return c},li:function(a,b,c){c=void 0===c?!1:c;var d=document.createElement("li"),e=this.span(a+": ",!0);b=this.span(b);c&&(d=this._status(d),b=this._mono(b));a==this.username&&d.setAttribute("class","my-message");d.appendChild(e);d.appendChild(b);return d},addMessage:function(a,b){var c=this.li(a,b);this.$add(c)},addSelfMessage:function(){this.addMessage(this.username,this.message);this.message=
""},sendMessage:function(){this.io.emit("chat message",this.message);this.addSelfMessage()},addStatus:function(a){a=this.li(":~Status~",a,!0);this.$add(a)},$add:function(a){this.$refs.messageDisplay.appendChild(a)},socketRegister:function(){var a=this,b=this.io;b.on("chat message",function(b){a.addMessage(b.username,b.message)});b.on("user join",function(b){a.addStatus("+ "+b+" joined the chat")});b.on("user leave",function(b){a.addStatus("- "+b+" left the chat")});b.on("connect",function(){b.emit("user set",
a.user)})}},mounted:function(){this.io=io();this.$set(this,"user",JSON.parse(this.$el.dataset.user));this.socketRegister()}});
